{"version":3,"sources":["../node_modules/tsup/assets/esm_shims.js","../src/index.ts","../src/hermes/test.ts","../src/utilities/constant.ts","../src/utilities/helpers.ts","../src/utilities/modifier/simply-result.ts","../src/utilities/writer/write-conflict.ts","../src/utilities/opeai-talker/index.ts","../src/utilities/opeai-talker/prompt.ts","../src/utilities/reader/read-prompt-file.ts","../src/utilities/extractor/extract-code-prompts.ts","../src/utilities/opeai-talker/send-message.ts","../src/hermes/base.ts","../src/utilities/webhook/index.ts","../src/hermes/review.ts","../src/hermes/create.ts","../src/hermes/modify.ts","../src/hermes/translate.ts","../src/utilities/creator/index.ts","../src/utilities/creator/code-generator.ts","../src/utilities/creator/constant.ts","../src/utilities/modifier/index.ts","../src/utilities/reader/index.ts","../src/utilities/reader/reader-directory.ts","../src/utilities/reader/reader-git-stage.ts","../src/utilities/extractor/extract-modify-funcs.ts"],"sourcesContent":["// Shim globals in esm bundle\nimport { fileURLToPath } from 'url'\nimport path from 'path'\n\nconst getFilename = () => fileURLToPath(import.meta.url)\nconst getDirname = () => path.dirname(getFilename())\n\nexport const __dirname = /* @__PURE__ */ getDirname()\nexport const __filename = /* @__PURE__ */ getFilename()\n","import 'isomorphic-fetch';\r\n\r\nimport { HermesReview, HermesTest, HermesTranslate } from './hermes';\r\nimport { userOptions } from './utilities/constant';\r\nimport CreateCLI from './utilities/creator';\r\nimport ModifyCLI from './utilities/modifier';\r\nimport ReadFiles from './utilities/reader';\r\nimport { HermesTypeEnum, IUserOptions, ReadTypeEnum } from './utilities/types';\r\n\r\nconst runMap: Record<HermesTypeEnum, () => void> = {\r\n  [HermesTypeEnum.Test]: async () => {\r\n    const testFilePaths = new ReadFiles();\r\n    const files = testFilePaths.getFileResults();\r\n    const hermes = new HermesTest();\r\n\r\n    for (const fileResult of files) {\r\n      await hermes.run(fileResult);\r\n    }\r\n  },\r\n  [HermesTypeEnum.Review]: async () => {\r\n    const reviewFiles = new ReadFiles();\r\n    const files = reviewFiles.getFileResults();\r\n    const hermes = new HermesReview();\r\n\r\n    for (const fileResult of files) {\r\n      await hermes.run(fileResult);\r\n    }\r\n    hermes.publishNotice();\r\n  },\r\n  [HermesTypeEnum.Create]: async () => {\r\n    const cli = new CreateCLI();\r\n\r\n    await cli.start();\r\n  },\r\n  [HermesTypeEnum.Modify]: async () => {\r\n    const reviewFiles = new ReadFiles();\r\n    const files = reviewFiles.getFileResults();\r\n    if (!files.length) return;\r\n\r\n    const cli = new ModifyCLI(files);\r\n    await cli.start();\r\n  },\r\n  [HermesTypeEnum.Translate]: async () => {\r\n    const testFilePaths = new ReadFiles({ fileExtensions: [] });\r\n    const files = testFilePaths.getFileResults(ReadTypeEnum.Directory);\r\n    const hermes = new HermesTranslate();\r\n\r\n    for (const fileResult of files) {\r\n      await hermes.run(fileResult);\r\n    }\r\n  },\r\n};\r\n\r\nexport function main(options?: IUserOptions) {\r\n  userOptions.init(options);\r\n  const type = userOptions.hermesType;\r\n\r\n  if (!runMap[type]) throw new Error('Invalid hermesType: ' + type);\r\n\r\n  if (userOptions.options.debug) {\r\n    console.log(\r\n      'Running hermes with options: ',\r\n      JSON.stringify(userOptions.options),\r\n    );\r\n  }\r\n\r\n  runMap[type]();\r\n}\r\n\r\nexport default main;\r\n","import fs from 'fs';\r\nimport path from 'path';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport { makeDirExist } from 'src/utilities/helpers';\r\nimport { getAllCodeBlock } from 'src/utilities/modifier/simply-result';\r\nimport { IReadFileResult } from 'src/utilities/types';\r\nimport getConflictResult from 'src/utilities/writer/write-conflict';\r\n\r\nimport HermesBase from './base';\r\n\r\nclass HermesTest extends HermesBase {\r\n  private getFileNameWithoutExtension(filePath: string): string {\r\n    return path.basename(filePath, path.extname(filePath));\r\n  }\r\n\r\n  private getFileExtension(filePath: string): string {\r\n    return path.extname(filePath);\r\n  }\r\n\r\n  private async writeTestMessageToFile(\r\n    { filePath, fileContent }: IReadFileResult,\r\n    message: string,\r\n  ): Promise<void> {\r\n    try {\r\n      const testFileDirName = userOptions.options.testFileDirName;\r\n      if (!testFileDirName) throw new Error('testFileDirName is not set');\r\n\r\n      const dirPath = path.join(path.dirname(filePath), testFileDirName);\r\n      const fileName = `${this.getFileNameWithoutExtension(filePath)}.${\r\n        userOptions.options.testFileType\r\n      }${this.getFileExtension(filePath)}`;\r\n      const testFilePath = path.join(dirPath, fileName);\r\n\r\n      makeDirExist(dirPath);\r\n\r\n      if (!fs.existsSync(testFilePath)) {\r\n        return fs.writeFileSync(testFilePath, message);\r\n      }\r\n\r\n      const sourceFileContent = fs.readFileSync(filePath, 'utf-8');\r\n      if (fileContent !== sourceFileContent) {\r\n        const testFileContent = fs.readFileSync(testFilePath, 'utf-8');\r\n        return fs.writeFileSync(\r\n          testFilePath,\r\n          `${testFileContent}\\n${message}\\n`,\r\n        );\r\n      }\r\n\r\n      return fs.writeFileSync(\r\n        testFilePath,\r\n        getConflictResult(fileContent, message),\r\n      );\r\n    } catch (error) {\r\n      console.error('Error writing message to file:', error);\r\n    }\r\n  }\r\n\r\n  public async run(fileResult: IReadFileResult): Promise<string> {\r\n    this.openai.resetParentMessage();\r\n    const message = await this.openai.run(fileResult);\r\n    if (!message?.length) return;\r\n\r\n    const extractTestsCode = message\r\n      .map((m) => getAllCodeBlock(m))\r\n      .join('\\n\\n');\r\n    await this.writeTestMessageToFile(fileResult, extractTestsCode);\r\n\r\n    return extractTestsCode;\r\n  }\r\n}\r\n\r\nexport default HermesTest;\r\n","import { ChatGPTAPIOptions } from 'chatgpt';\r\nimport { execSync } from 'child_process';\r\nimport { config } from 'dotenv';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nimport { HermesTypeEnum, IUserOptions, ReadTypeEnum } from './types';\r\n\r\nexport const OPENAI_API_KEY_NAME = 'OPENAI_API_KEY';\r\nexport const OPENAI_SESSION_TOKEN_NAME = 'OPENAI_SESSION_TOKEN';\r\n\r\nexport const OPENAI_MAX_RETRY = 3;\r\nexport const OPENAI_MAX_CONTINUES = 5;\r\n\r\nconst DEFAULT_MODELS = {\r\n  apiModel: 'gpt-3.5-turbo',\r\n  proxyModel: 'text-davinci-002-render-sha',\r\n};\r\n\r\nexport const ROOT_SRC_DIR_PATH = __dirname;\r\n\r\nclass UserOptionsClass {\r\n  options: IUserOptions;\r\n\r\n  private userOptionsDefault: IUserOptions = {\r\n    debug: false,\r\n    hermesType: HermesTypeEnum.Review,\r\n    openAIModel: '',\r\n    openAIProxyUrl: 'https://bypass.churchless.tech/api/conversation',\r\n    openAIMaxTokens: 4096,\r\n    readType: ReadTypeEnum.GitStage,\r\n    readGitStatus: 'R, M, A',\r\n    readFilesRootName: 'src',\r\n    readFileExtensions: '.ts,.tsx',\r\n    testFileType: 'test',\r\n    testFileDirName: '__test__',\r\n    reviewReportWebhook: '',\r\n    translate: 'zh,en',\r\n  };\r\n\r\n  get hermesType(): HermesTypeEnum {\r\n    if (!this.options.hermesType) throw new Error('hermesType is not set');\r\n    return this.options.hermesType;\r\n  }\r\n\r\n  private getOpenAIKeyFromNpmConfig(key: string): string {\r\n    try {\r\n      return execSync(`npm config get ${key}`).toString().trim();\r\n    } catch (error) {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  get openAIKey(): string {\r\n    if (!this.options.openAIKey) {\r\n      this.options.openAIKey =\r\n        this.getOpenAIKeyFromNpmConfig(OPENAI_API_KEY_NAME);\r\n    }\r\n\r\n    if (!this.options.openAIKey) throw new Error('openAIKey is not set');\r\n\r\n    if (process.env.DEBUG)\r\n      console.log(`openAI key: \"${this.options.openAIKey}\"`);\r\n\r\n    return this.options.openAIKey;\r\n  }\r\n\r\n  get openAISessionToken(): string {\r\n    if (!this.options.openAISessionToken) {\r\n      this.options.openAISessionToken = this.getOpenAIKeyFromNpmConfig(\r\n        OPENAI_SESSION_TOKEN_NAME,\r\n      );\r\n    }\r\n\r\n    return this.options.openAISessionToken;\r\n  }\r\n\r\n  get openAISendByProxy(): boolean {\r\n    return (\r\n      this.options.openAIProxyUrl &&\r\n      this.openAISessionToken &&\r\n      this.openAISessionToken !== 'undefined'\r\n    );\r\n  }\r\n\r\n  get openAIModel(): string {\r\n    if (this.openAISendByProxy) {\r\n      if (this.options.openAIModel === DEFAULT_MODELS.apiModel) {\r\n        console.warn(\r\n          '[ ðŸ§™ hermes ] openAIModel is set to gpt-3.5-turbo, but use proxy type, so openAIModel is set to text-davinci-002-render-sha',\r\n        );\r\n        return (this.options.openAIModel = DEFAULT_MODELS.proxyModel);\r\n      }\r\n\r\n      return this.options.openAIModel || DEFAULT_MODELS.proxyModel;\r\n    }\r\n    return this.options.openAIModel || DEFAULT_MODELS.apiModel;\r\n  }\r\n\r\n  get openAIOptions(): ChatGPTAPIOptions['completionParams'] {\r\n    if (!this.openAIModel) throw new Error('openAIModel is not set');\r\n\r\n    return {\r\n      temperature: 0,\r\n      top_p: 0.4,\r\n      stop: ['###'],\r\n      model: this.openAIModel,\r\n      max_tokens: this.options.openAIMaxTokens,\r\n    };\r\n  }\r\n\r\n  get readFilesRoot(): string {\r\n    if (!this.options.readFilesRootName)\r\n      throw new Error('readFilesRootName is not set');\r\n    return path.join(process.cwd(), this.options.readFilesRootName);\r\n  }\r\n\r\n  get readFilesExtensions(): string[] {\r\n    if (!this.options.readFileExtensions)\r\n      throw new Error('readFileExtensions is not set');\r\n    return this.options.readFileExtensions.split(',');\r\n  }\r\n\r\n  get readFileType(): ReadTypeEnum {\r\n    if (!this.options.readType) throw new Error('readType is not set');\r\n    return this.options.readType;\r\n  }\r\n\r\n  get openAIPrompt(): string {\r\n    const { openAIPrompt } = this.options;\r\n\r\n    if (!openAIPrompt) return '';\r\n\r\n    const filePaths = openAIPrompt.split(',');\r\n\r\n    const filesContent = filePaths\r\n      .filter(\r\n        (filePath) => fs.existsSync(filePath) && fs.statSync(filePath).isFile(),\r\n      )\r\n      .map((filePath) => fs.readFileSync(filePath.trim(), 'utf-8'))\r\n      .join('\\n');\r\n\r\n    return filesContent\r\n      ? `Note here is context that you need understand: ${filesContent}.`\r\n      : openAIPrompt;\r\n  }\r\n\r\n  private convertProcessEnvToUserOptions(\r\n    processEnv: NodeJS.ProcessEnv,\r\n  ): IUserOptions {\r\n    return {\r\n      debug: process.env.DEBUG === 'true',\r\n      securityRegex: process.env.SECURITY_REGEX || '',\r\n      openAIKey: processEnv.OPENAI_API_KEY,\r\n      openAISessionToken: processEnv.OPENAI_SESSION_TOKEN,\r\n      openAIProxyUrl:\r\n        processEnv.OPENAI_PROXY_URL || this.userOptionsDefault.openAIProxyUrl,\r\n      openAIModel:\r\n        processEnv.OPENAI_MODEL || this.userOptionsDefault.openAIModel,\r\n      openAIMaxTokens: Number(\r\n        processEnv.OPENAI_MAX_TOKENS || this.userOptionsDefault.openAIMaxTokens,\r\n      ),\r\n      /**\r\n       * Read file options\r\n       */\r\n      readType:\r\n        (processEnv.READ_TYPE as ReadTypeEnum) ||\r\n        this.userOptionsDefault.readType,\r\n      readGitStatus:\r\n        processEnv.READ_GIT_STATUS || this.userOptionsDefault.readGitStatus,\r\n      readFilesRootName:\r\n        processEnv.READ_FILES_ROOT_NAME ||\r\n        this.userOptionsDefault.readFilesRootName,\r\n      readFileExtensions:\r\n        processEnv.READ_FILE_EXTENSIONS ||\r\n        this.userOptionsDefault.readFileExtensions,\r\n      /**\r\n       * Test file options\r\n       */\r\n      testFileType:\r\n        processEnv.TEST_FILE_TYPE || this.userOptionsDefault.testFileType,\r\n      testFileDirName:\r\n        processEnv.TEST_FILE_DIR_NAME ||\r\n        this.userOptionsDefault.testFileDirName,\r\n      /**\r\n       * Review options\r\n       */\r\n      reviewReportWebhook: processEnv.REVIEW_REPORT_WEBHOOK,\r\n      /**\r\n       * Translate options\r\n       */\r\n      translate: processEnv.TRANSLATE || this.userOptionsDefault.translate,\r\n    };\r\n  }\r\n\r\n  public securityPrompt(prompt: string): string {\r\n    if (!this.options.securityRegex) return prompt;\r\n\r\n    const regex = new RegExp(this.options.securityRegex, 'gi');\r\n\r\n    return prompt.replace(regex, 'REMOVED');\r\n  }\r\n\r\n  public init(userOptions: IUserOptions = {}) {\r\n    config();\r\n    config({ path: path.join(process.cwd(), '.env.local') });\r\n    const envUserOptions = this.convertProcessEnvToUserOptions(process.env);\r\n\r\n    if (process.env.DEBUG) {\r\n      console.log('envUserOptions: ', envUserOptions);\r\n      console.log('userOptions: ', userOptions);\r\n    }\r\n\r\n    this.options = Object.assign(\r\n      {},\r\n      this.userOptionsDefault,\r\n      envUserOptions,\r\n      userOptions,\r\n    );\r\n  }\r\n}\r\n\r\nexport const userOptions = new UserOptionsClass();\r\n\r\nexport const codeBlocksRegex = /```([\\s\\S]*?)```/g;\r\n\r\nexport const codeBlocksMdSymbolRegex = /```(\\w?)*/g;\r\n\r\nexport const reviewFileName = '.hermes_review.md';\r\n","import { execSync } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nexport const getFileNameByPath = (filePath: string) =>\r\n  filePath && path.basename(filePath, path.extname(filePath));\r\n\r\nexport const getUserEmail = () => {\r\n  const output = execSync('git config user.email').toString().trim();\r\n  return output;\r\n};\r\n\r\nexport const deleteFileSync = (filePath: string) => {\r\n  if (!fs.existsSync(filePath)) return;\r\n  fs.unlinkSync(filePath);\r\n};\r\n\r\nexport const makeDirExist = (dirPath: string) => {\r\n  if (fs.existsSync(dirPath)) return;\r\n  fs.mkdirSync(dirPath, { recursive: true });\r\n};\r\n\r\nexport const getFileNameToCamelCase = (\r\n  fileName: string,\r\n  isFirstUpper = false,\r\n) => {\r\n  if (!fileName) return '';\r\n  if (fileName.indexOf('-') === -1) {\r\n    return isFirstUpper\r\n      ? fileName.slice(0, 1).toUpperCase() + fileName.slice(1)\r\n      : fileName.slice(0, 1).toLowerCase() + fileName.slice(1);\r\n  }\r\n\r\n  fileName\r\n    .split('-')\r\n    .map((word, index) => {\r\n      if (index !== 0) {\r\n        return `${word.slice(0, 1).toUpperCase()}${word.slice(1)}`;\r\n      }\r\n\r\n      return isFirstUpper\r\n        ? word.slice(0, 1).toUpperCase()\r\n        : word.slice(0, 1).toLowerCase();\r\n    })\r\n    .join('');\r\n};\r\n\r\nexport * from './modifier/simply-result';\r\n","import {\r\n  codeBlocksMdSymbolRegex,\r\n  codeBlocksRegex,\r\n  reviewFileName,\r\n} from 'src/utilities/constant';\r\n\r\nexport const replaceCodeBlock = (\r\n  data: string,\r\n  placeholder: string = `check your local __${reviewFileName}__`,\r\n) => {\r\n  return data.replace(codeBlocksRegex, placeholder);\r\n};\r\n\r\nexport const getAllCodeBlock = (data: string): string => {\r\n  const codeBlocks = data.match(codeBlocksRegex);\r\n  return codeBlocks\r\n    ? codeBlocks\r\n        ?.map((t) =>\r\n          codeBlocksMdSymbolRegex.test(t)\r\n            ? t.replace(codeBlocksMdSymbolRegex, '')\r\n            : t,\r\n        )\r\n        .join('')\r\n    : data;\r\n};\r\n\r\nexport const simplyReviewData = (data: string) => {\r\n  return replaceCodeBlock(data)\r\n    .replace(/'/g, '')\r\n    .replace(/`/g, '__')\r\n    .replace(/\\n/g, '\\\\r');\r\n};\r\n","function getConflictResult(\r\n  sourceContent: string,\r\n  targetContent: string,\r\n): string {\r\n  const removeStartAndEndEmptyLine = (content: string): string[] => {\r\n    const lines = content.split('\\n');\r\n    let start = 0;\r\n    let end = lines.length - 1;\r\n    return lines.filter((line, index) => {\r\n      if (line.trim() === '' && index === start) {\r\n        start += 1;\r\n        return false;\r\n      }\r\n      if (line.trim() === '' && index === end) {\r\n        end -= 1;\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n  };\r\n\r\n  const findFirstNotSameLineNumber = (\r\n    sourceLines: string[],\r\n    targetLines: string[],\r\n  ): number => {\r\n    let i = 0;\r\n    for (; i < sourceLines.length && i < targetLines.length; i++) {\r\n      if (sourceLines[i] !== targetLines[i]) {\r\n        break;\r\n      }\r\n    }\r\n    return i;\r\n  };\r\n\r\n  const findReverseSameLinesLength = (\r\n    sourceLines: string[],\r\n    targetLines: string[],\r\n  ): number => {\r\n    let i = 0;\r\n    const sourceLinesReverse = sourceLines.slice().reverse();\r\n    const targetLinesReverse = targetLines.slice().reverse();\r\n\r\n    for (\r\n      ;\r\n      i < sourceLinesReverse.length && i < targetLinesReverse.length;\r\n      i++\r\n    ) {\r\n      if (sourceLinesReverse[i] !== targetLinesReverse[i]) {\r\n        break;\r\n      }\r\n    }\r\n    return i;\r\n  };\r\n\r\n  const sourceLines = removeStartAndEndEmptyLine(sourceContent);\r\n  const targetLines = removeStartAndEndEmptyLine(targetContent);\r\n\r\n  if (sourceLines.join('\\n') === targetLines.join('\\n')) {\r\n    return sourceContent;\r\n  }\r\n\r\n  const firstNotSameLineNumber = findFirstNotSameLineNumber(\r\n    sourceLines,\r\n    targetLines,\r\n  );\r\n  const reverseSameLinesLength = findReverseSameLinesLength(\r\n    sourceLines,\r\n    targetLines,\r\n  );\r\n\r\n  const resultLines: string[] = [\r\n    ...sourceLines.slice(0, firstNotSameLineNumber),\r\n    '<<<<<<< HEAD',\r\n    ...sourceLines.slice(\r\n      firstNotSameLineNumber,\r\n      sourceLines.length - reverseSameLinesLength,\r\n    ),\r\n    '=======',\r\n    ...targetLines.slice(\r\n      firstNotSameLineNumber,\r\n      targetLines.length - reverseSameLinesLength,\r\n    ),\r\n    '>>>>>>> Incoming',\r\n    ...sourceLines.slice(sourceLines.length - reverseSameLinesLength),\r\n  ];\r\n\r\n  return resultLines.join('\\n');\r\n}\r\n\r\nexport default getConflictResult;\r\n","import { AbortController } from 'abort-controller';\r\nimport chalk from 'chalk';\r\nimport {\r\n  ChatGPTAPI,\r\n  ChatGPTUnofficialProxyAPI,\r\n  ChatMessage,\r\n  SendMessageOptions,\r\n} from 'chatgpt';\r\nimport ora from 'ora';\r\nimport { userOptions as options } from 'src/utilities/constant';\r\nimport { HermesPrompt } from 'src/utilities/opeai-talker/prompt';\r\n\r\nimport { handleContinueMessage, sendMessageWithRetry } from './send-message';\r\nimport { HermesTypeEnum, IReadFileResult } from '../types';\r\n\r\nexport class ChatgptProxyAPI {\r\n  private chatApi: ChatGPTUnofficialProxyAPI | ChatGPTAPI;\r\n  private parentMsg?: ChatMessage;\r\n\r\n  constructor() {\r\n    this.initChatApi();\r\n  }\r\n\r\n  get needPrintMsg(): boolean {\r\n    return true;\r\n  }\r\n\r\n  private initChatApi() {\r\n    if (process.env.DEBUG)\r\n      console.log(`openAI session token: \"${options.openAISessionToken}\"`);\r\n\r\n    console.log('[ ðŸ§™ hermes ] Using Model:', chalk.green(options.openAIModel));\r\n    if (!options.openAISendByProxy) {\r\n      this.chatApi = new ChatGPTAPI({\r\n        apiKey: options.openAIKey,\r\n        completionParams: options.openAIOptions,\r\n        debug: options.options.debug,\r\n      });\r\n      return;\r\n    }\r\n\r\n    this.chatApi = new ChatGPTUnofficialProxyAPI({\r\n      model: options.openAIModel,\r\n      accessToken: options.openAISessionToken,\r\n      apiReverseProxyUrl: options.options.openAIProxyUrl,\r\n    });\r\n  }\r\n\r\n  private generatePrompt(fileRes: IReadFileResult): string[] {\r\n    const hermesType = new HermesPrompt(options.hermesType);\r\n\r\n    return hermesType.generatePrompt(fileRes);\r\n  }\r\n\r\n  private isReviewPassed(msg: string): boolean {\r\n    if (options.hermesType !== HermesTypeEnum.Review) return true;\r\n    return /perfect!/gi.test(msg);\r\n  }\r\n\r\n  private oraStart(text = '', needPrintMsg = this.needPrintMsg): ora.Ora {\r\n    if (!needPrintMsg) return ora();\r\n\r\n    return ora({\r\n      text,\r\n      spinner: {\r\n        interval: 800,\r\n        frames: ['ðŸª„', 'ðŸ§™', 'ðŸª„', 'ðŸ§™', 'ðŸª„', 'ðŸ§™', 'ðŸª„', 'ðŸ§™'],\r\n      },\r\n    }).start();\r\n  }\r\n\r\n  private async sendPrompt(\r\n    prompt: string,\r\n    prevMsg?: Partial<ChatMessage>,\r\n  ): Promise<ChatMessage> {\r\n    const securityPrompt = options.securityPrompt(prompt);\r\n\r\n    if (!prevMsg) {\r\n      return await sendMessageWithRetry(() =>\r\n        this.chatApi.sendMessage(securityPrompt),\r\n      );\r\n    }\r\n\r\n    const reviewSpinner = this.oraStart();\r\n    const controller = new AbortController();\r\n    const signal = controller.signal;\r\n    const sendOptions: SendMessageOptions = {\r\n      ...prevMsg,\r\n      timeoutMs: 1000 * 60 * 5,\r\n      abortSignal: signal,\r\n      onProgress: (partialResponse) => {\r\n        reviewSpinner.text = partialResponse.text;\r\n      },\r\n    };\r\n\r\n    try {\r\n      let resMsg = await sendMessageWithRetry(() =>\r\n        this.chatApi.sendMessage(securityPrompt, sendOptions),\r\n      );\r\n\r\n      resMsg = await handleContinueMessage(resMsg, (msg, options) =>\r\n        this.chatApi.sendMessage(msg, { ...sendOptions, ...options }),\r\n      );\r\n\r\n      const isReviewPassed = this.isReviewPassed(resMsg.text);\r\n      const colorText = isReviewPassed\r\n        ? chalk.green(resMsg.text)\r\n        : chalk.yellow(resMsg.text);\r\n\r\n      reviewSpinner[isReviewPassed ? 'succeed' : 'fail'](\r\n        `[ ðŸ§™ hermes ] ${colorText} \\n `,\r\n      );\r\n\r\n      return resMsg;\r\n    } catch (error) {\r\n      reviewSpinner.fail(`[ ðŸ§™ hermes ] ${error.message} \\n `);\r\n      controller.abort();\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async sendFileRes(fileRes: IReadFileResult): Promise<string[]> {\r\n    const promptArray = this.generatePrompt(fileRes);\r\n    const [systemPrompt, ...codePrompts] = promptArray;\r\n    if (options.options.debug) {\r\n      console.log('[ ðŸ§™ hermes ] systemPrompt:', systemPrompt);\r\n      console.log(\r\n        '[ ðŸ§™ hermes ] codePrompts:',\r\n        codePrompts.length,\r\n        codePrompts,\r\n      );\r\n    }\r\n    if (!codePrompts.length) return [];\r\n\r\n    const msgArray: string[] = [];\r\n    let msg = this.parentMsg || (await this.sendPrompt(systemPrompt));\r\n\r\n    for (const prompt of codePrompts) {\r\n      msg = await this.sendPrompt(prompt, {\r\n        conversationId: msg?.conversationId,\r\n        parentMessageId: msg?.id,\r\n      });\r\n      msgArray.push(msg.text);\r\n      this.parentMsg = msg;\r\n    }\r\n\r\n    return msgArray;\r\n  }\r\n\r\n  public resetParentMsg() {\r\n    this.parentMsg = undefined;\r\n  }\r\n  async run(fileRes: IReadFileResult): Promise<string[]> {\r\n    const reviewSpinner = this.oraStart(\r\n      chalk.cyan(`[ ðŸ§™ hermes ] start ${options.hermesType} your code... \\n`),\r\n    );\r\n\r\n    return this.sendFileRes(fileRes)\r\n      .then((res) => {\r\n        reviewSpinner.succeed(\r\n          chalk.green(\r\n            `ðŸŽ‰ðŸŽ‰ [ ðŸ§™ hermes ] ${options.hermesType} code successfully! ðŸŽ‰ðŸŽ‰\\n `,\r\n          ),\r\n        );\r\n        return res;\r\n      })\r\n      .catch((error) => {\r\n        console.error('run error:', error);\r\n        reviewSpinner.fail(\r\n          chalk.red(\r\n            `ðŸ¤”ðŸ¤” [ ðŸ§™ hermes ] ${options.hermesType} your code failed! ðŸ¤”ðŸ¤”\\n`,\r\n          ),\r\n        );\r\n        return ['[ ðŸ§™ hermes ] call OpenAI API failed!'];\r\n      })\r\n      .finally(() => {\r\n        reviewSpinner.stop();\r\n      });\r\n  }\r\n}\r\n","import fs from 'fs';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport { readPromptFile } from 'src/utilities/reader/read-prompt-file';\r\n\r\nimport { ExtractCodePrompts } from '../extractor/extract-code-prompts';\r\nimport { HermesTypeEnum, IReadFileResult } from '../types';\r\n\r\nexport class HermesPrompt {\r\n  private hermesTypeMap: Record<\r\n    HermesTypeEnum,\r\n    (fileResult: IReadFileResult) => string[]\r\n  > = {\r\n    [HermesTypeEnum.Test]: (fileResult) => {\r\n      const fileContent =\r\n        fileResult.fileContent ||\r\n        fs.readFileSync(fileResult.filePath!, 'utf-8');\r\n      const testsPrompt = readPromptFile('tests.txt');\r\n      const basePrompt = `\r\n        ${testsPrompt}\r\n        ${userOptions.openAIPrompt || ''}\r\n      `;\r\n\r\n      const codePicker = new ExtractCodePrompts();\r\n\r\n      const codePrompts = codePicker.extractFunctionOrClassCodeArray({\r\n        ...fileResult,\r\n        fileContent,\r\n      });\r\n\r\n      return [basePrompt, ...codePrompts];\r\n    },\r\n    [HermesTypeEnum.Review]: (fileResult) => {\r\n      const fileContent =\r\n        fileResult.fileContent ||\r\n        fs.readFileSync(fileResult.filePath!, 'utf-8');\r\n      const reviewPrompt = readPromptFile('review.txt');\r\n      const basePrompt = `\r\n        ${reviewPrompt}\r\n        ${userOptions.openAIPrompt || ''}\r\n      `;\r\n\r\n      const codePicker = new ExtractCodePrompts();\r\n\r\n      const codePrompts = codePicker.extractFunctionOrClassCodeArray({\r\n        ...fileResult,\r\n        fileContent,\r\n      });\r\n\r\n      return [basePrompt, ...codePrompts];\r\n    },\r\n    [HermesTypeEnum.Translate]: (fileResult) => {\r\n      const fileContent =\r\n        fileResult.fileContent ||\r\n        fs.readFileSync(fileResult.filePath!, 'utf-8');\r\n      const readPrompt = readPromptFile('translate.txt');\r\n      const basePrompt = `\r\n        ${readPrompt}\r\n        - Target language: ${userOptions.options.translate}\r\n        ${userOptions.openAIPrompt || ''}\r\n      `;\r\n\r\n      return [basePrompt, fileContent];\r\n    },\r\n    [HermesTypeEnum.Create]: ({ prompts }) => {\r\n      if (!prompts) throw new Error('prompts is required for create');\r\n      const createPrompt = readPromptFile('create.txt');\r\n\r\n      return [\r\n        createPrompt,\r\n        ...[\r\n          `${userOptions.openAIPrompt}\\n${prompts.slice(0, 1)}`,\r\n          ...prompts.slice(1),\r\n        ],\r\n      ];\r\n    },\r\n    [HermesTypeEnum.Modify]: ({ prompts }) => {\r\n      const readPrompt = readPromptFile('modify.txt');\r\n\r\n      return [\r\n        readPrompt,\r\n        ...[\r\n          `${userOptions.openAIPrompt}\\n${prompts.slice(0, 1)}`,\r\n          ...prompts.slice(1),\r\n        ],\r\n      ];\r\n    },\r\n  };\r\n\r\n  constructor(private hermesType: HermesTypeEnum) {}\r\n\r\n  public generatePrompt(fileResult: IReadFileResult): string[] {\r\n    if (!fileResult)\r\n      throw new Error('File path is required for generatePrompt');\r\n    if (!this.hermesTypeMap[this.hermesType])\r\n      throw new Error('Invalid hermesType: ' + this.hermesType);\r\n\r\n    return this.hermesTypeMap[this.hermesType](fileResult);\r\n  }\r\n}\r\n","import fs from 'fs';\r\nimport path from 'path';\r\nimport { ROOT_SRC_DIR_PATH } from 'src/utilities/constant';\r\n\r\nexport const readPromptFile = (fileName: string): string => {\r\n  const userLocalPath = path.join(process.cwd(), 'prompt', fileName);\r\n  if (fs.existsSync(userLocalPath)) {\r\n    return fs.readFileSync(userLocalPath, 'utf-8');\r\n  }\r\n\r\n  return fs.readFileSync(\r\n    path.join(ROOT_SRC_DIR_PATH, 'prompt', fileName),\r\n    'utf-8',\r\n  );\r\n};\r\n","import generate from '@babel/generator';\r\nimport { parse } from '@babel/parser';\r\nimport traverse, { NodePath } from '@babel/traverse';\r\nimport fs from 'fs';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport { IReadFileResult } from '../types';\r\n\r\nconst traverseFunc =\r\n  typeof traverse === 'function' ? traverse : (traverse as any).default;\r\nconst generateFunc =\r\n  typeof generate === 'function' ? generate : (generate as any).default;\r\n\r\nexport class ExtractCodePrompts {\r\n  private remainingCode: string[];\r\n  private remainingEndIndex;\r\n\r\n  constructor() {\r\n    this.remainingCode = [];\r\n    this.remainingEndIndex = 0;\r\n  }\r\n\r\n  private isFunctionOrClass(nodePath: NodePath | null): boolean {\r\n    if (!nodePath) return true;\r\n\r\n    const isVariableDeclarationFunction =\r\n      nodePath.isVariableDeclaration() &&\r\n      nodePath.node.declarations.some(\r\n        (d) =>\r\n          d.init &&\r\n          (d.init.type === 'FunctionExpression' ||\r\n            d.init.type === 'ArrowFunctionExpression'),\r\n      );\r\n\r\n    return (\r\n      nodePath.isFunction() ||\r\n      nodePath.isClass() ||\r\n      isVariableDeclarationFunction\r\n    );\r\n  }\r\n\r\n  public extractFunctionOrClassCodeArray({\r\n    fileContent,\r\n    filePath,\r\n  }: IReadFileResult): string[] {\r\n    try {\r\n      const ast = parse(fileContent, {\r\n        sourceType: 'module',\r\n        plugins: ['typescript', 'jsx'],\r\n      });\r\n\r\n      traverseFunc(ast, {\r\n        enter: (nodePath) => {\r\n          if (Number(nodePath.node.start) < this.remainingEndIndex) return;\r\n\r\n          if (!this.isFunctionOrClass(nodePath)) return;\r\n\r\n          this.remainingEndIndex = Number(nodePath.node.end);\r\n          const codeSnippet = generateFunc(nodePath.node).code;\r\n          this.remainingCode.push(codeSnippet);\r\n        },\r\n      });\r\n\r\n      return this.remainingCode;\r\n    } catch (e) {\r\n      if (userOptions.options?.debug) console.error('Babel parse error: ', e);\r\n      return [\r\n        fs.existsSync(filePath)\r\n          ? fs.readFileSync(filePath, 'utf-8')\r\n          : fileContent,\r\n      ];\r\n    }\r\n  }\r\n}\r\n","import { ChatMessage, SendMessageOptions } from 'chatgpt';\r\nimport {\r\n  OPENAI_MAX_CONTINUES,\r\n  OPENAI_MAX_RETRY,\r\n  codeBlocksMdSymbolRegex,\r\n} from 'src/utilities/constant';\r\n\r\nexport const sendMessageWithRetry = async (\r\n  sendMessage: () => Promise<ChatMessage>,\r\n  retries = OPENAI_MAX_RETRY,\r\n  retryDelay = 3000,\r\n): Promise<ChatMessage> => {\r\n  for (let retry = 0; retry < retries; retry++) {\r\n    try {\r\n      const res = await sendMessage();\r\n      return res;\r\n    } catch (error) {\r\n      if (error.statusCode === 401) {\r\n        throw error;\r\n      } else if (error.statusCode === 429) {\r\n        await new Promise((resolve) => setTimeout(resolve, retryDelay));\r\n      } else {\r\n        if (retry === retries) {\r\n          throw error;\r\n        }\r\n        console.log(\r\n          `[ ðŸ§™ hermes ] sendMessage failed, retrying... (${\r\n            retry + 1\r\n          }/${retries})`,\r\n        );\r\n      }\r\n    }\r\n  }\r\n  throw new Error('sendMessage failed after retries');\r\n};\r\n\r\nexport const handleContinueMessage = async (\r\n  message: ChatMessage,\r\n  sendMessage: (\r\n    messageText: string,\r\n    sendOptions?: SendMessageOptions,\r\n  ) => Promise<ChatMessage>,\r\n  maxContinueAttempts = OPENAI_MAX_CONTINUES,\r\n): Promise<ChatMessage> => {\r\n  let resMessage = message;\r\n  let continueAttempts = 0;\r\n\r\n  if ((resMessage.text.match(codeBlocksMdSymbolRegex) || []).length % 2 === 0) {\r\n    return resMessage;\r\n  }\r\n\r\n  while (continueAttempts < maxContinueAttempts) {\r\n    const continueMessage = 'continue';\r\n    const nextMessage = await sendMessage(continueMessage, {\r\n      conversationId: resMessage.conversationId,\r\n      parentMessageId: resMessage.id,\r\n    } as SendMessageOptions);\r\n\r\n    console.log(\r\n      `[ ðŸ§™ hermes ] continue message... (${\r\n        continueAttempts + 1\r\n      }/${maxContinueAttempts})`,\r\n    );\r\n\r\n    resMessage = {\r\n      ...resMessage,\r\n      ...nextMessage,\r\n      text: `${resMessage.text}${nextMessage.text}`,\r\n    };\r\n\r\n    if (nextMessage.text.match(codeBlocksMdSymbolRegex)?.length > 0) break;\r\n\r\n    continueAttempts++;\r\n  }\r\n  return resMessage;\r\n};\r\n","import { ChatgptProxyAPI } from 'src/utilities/opeai-talker';\r\nimport { IReadFileResult } from 'src/utilities/types';\r\n\r\nabstract class HermesBase {\r\n  public openai: ChatgptProxyAPI;\r\n\r\n  constructor() {\r\n    this.openai = new ChatgptProxyAPI();\r\n  }\r\n\r\n  abstract run(fileResult: IReadFileResult): Promise<string | string[]>;\r\n}\r\n\r\nexport default HermesBase;\r\n","import { exec } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport {\r\n  codeBlocksRegex,\r\n  reviewFileName,\r\n  userOptions,\r\n} from 'src/utilities/constant';\r\nimport {\r\n  deleteFileSync,\r\n  getUserEmail,\r\n  simplyReviewData,\r\n} from 'src/utilities/helpers';\r\n\r\nimport { INoticeTask, ISeatalkNoticeOptions } from './constant';\r\n\r\n/**\r\n * Webhook notifier\r\n * @param {string} channel The webhook channel\r\n * @param {string} userEmail The user email\r\n */\r\nclass WebhookNotifier {\r\n  private readonly userEmail: string;\r\n  private readonly channel: string;\r\n  private tasks: string[];\r\n\r\n  constructor({\r\n    channel = userOptions.options.reviewReportWebhook,\r\n    userEmail = '',\r\n  }: ISeatalkNoticeOptions = {}) {\r\n    this.tasks = [];\r\n\r\n    if (!channel) return;\r\n    this.userEmail = userEmail;\r\n    this.channel = channel;\r\n  }\r\n\r\n  /**\r\n   * Add a notice task\r\n   */\r\n  public addNoticeTask(task: INoticeTask) {\r\n    if (!task) return;\r\n\r\n    this.tasks.push(\r\n      `__${path.dirname(task.filePath).split('/').pop()}/${path.basename(\r\n        task.filePath,\r\n      )}__ \\\\râ€¢ ${task.message}`,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Publish all notices to the webhook channel\r\n   */\r\n  async publishNotice() {\r\n    if (!this.tasks?.length) return;\r\n    const content = this.tasks.join('\\\\r\\\\r\\\\n');\r\n    const reviewFilePath = `${path.join(process.cwd(), reviewFileName)}`;\r\n\r\n    deleteFileSync(reviewFilePath);\r\n\r\n    // Write the output text to a file if there are code blocks\r\n    if (codeBlocksRegex.test(content)) {\r\n      fs.writeFileSync(reviewFilePath, content, 'utf-8');\r\n    }\r\n\r\n    // If no channel is provided, log the content to the console\r\n    if (userOptions.options.debug) {\r\n      console.log(\r\n        'publishNotice: channel=%s, content=%s',\r\n        this.channel,\r\n        content,\r\n      );\r\n    }\r\n\r\n    if (!this.channel) return;\r\n\r\n    const data = `<mention-tag target=\\\\\"seatalk://user?email=${\r\n      this.userEmail || getUserEmail()\r\n    }\\\\\" />\\\\r\\\\r${simplyReviewData(content)}`;\r\n\r\n    try {\r\n      await exec(\r\n        `curl -i -X POST -H 'Content-Type: application/json' -d '{ \"tag\": \"markdown\", \"markdown\": {\"content\": \"${data}\"}}' ${this.channel}`,\r\n      );\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n}\r\n\r\nexport default WebhookNotifier;\r\n","import { IReadFileResult } from 'src/utilities/types';\r\nimport WebhookNotifier from 'src/utilities/webhook';\r\n\r\nimport HermesBase from './base';\r\n\r\nclass HermesReview extends HermesBase {\r\n  private publishChannel: WebhookNotifier;\r\n\r\n  constructor() {\r\n    super();\r\n    this.publishChannel = new WebhookNotifier();\r\n  }\r\n\r\n  private async postAIMessage(\r\n    filePath: string,\r\n    message: string,\r\n  ): Promise<void> {\r\n    this.publishChannel.addNoticeTask({ filePath, message });\r\n  }\r\n\r\n  public async run(fileResult: IReadFileResult): Promise<string> {\r\n    this.openai.resetParentMessage();\r\n    const message = await this.openai.run(fileResult);\r\n    if (!message?.length) return;\r\n\r\n    const resMessage = message.join('\\n\\n---\\n\\n');\r\n    this.postAIMessage(fileResult.filePath!, resMessage);\r\n    return resMessage;\r\n  }\r\n\r\n  public publishNotice(): void {\r\n    this.publishChannel.publishNotice();\r\n  }\r\n}\r\n\r\nexport default HermesReview;\r\n","import { codeBlocksRegex } from 'src/utilities/constant';\r\nimport { getAllCodeBlock } from 'src/utilities/modifier/simply-result';\r\nimport { IReadFileResult } from 'src/utilities/types';\r\n\r\nimport HermesBase from './base';\r\n\r\nclass HermesCreate extends HermesBase {\r\n  public async run(fileResult: IReadFileResult): Promise<string[]> {\r\n    const message = await this.openai.run(fileResult);\r\n    if (!message?.length) return [];\r\n    if (!codeBlocksRegex.test(message.join(''))) return [];\r\n\r\n    const extractTestsCode = message.map((m) => getAllCodeBlock(m));\r\n\r\n    return extractTestsCode;\r\n  }\r\n}\r\n\r\nexport default HermesCreate;\r\n","import { codeBlocksRegex } from 'src/utilities/constant';\r\nimport { getAllCodeBlock } from 'src/utilities/modifier/simply-result';\r\nimport { IReadFileResult } from 'src/utilities/types';\r\n\r\nimport HermesBase from './base';\r\n\r\nclass HermesModify extends HermesBase {\r\n  public async run(fileResult: IReadFileResult): Promise<string[]> {\r\n    const message = await this.openai.run(fileResult);\r\n    if (!message?.length) return [];\r\n    if (!codeBlocksRegex.test(message.join(''))) return [];\r\n\r\n    const extractTestsCode = message.map((m) => getAllCodeBlock(m));\r\n\r\n    return extractTestsCode;\r\n  }\r\n}\r\n\r\nexport default HermesModify;\r\n","import fs from 'fs';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport { getAllCodeBlock } from 'src/utilities/modifier/simply-result';\r\nimport { IReadFileResult } from 'src/utilities/types';\r\nimport getConflictResult from 'src/utilities/writer/write-conflict';\r\n\r\nimport HermesBase from './base';\r\n\r\nclass HermesTranslate extends HermesBase {\r\n  private writeMessageToFile(\r\n    { filePath, fileContent }: IReadFileResult,\r\n    message: string,\r\n  ) {\r\n    try {\r\n      if (userOptions.options.debug) {\r\n        console.log('Write message to file:', filePath, message);\r\n      }\r\n      fs.writeFileSync(filePath, getConflictResult(fileContent, message));\r\n    } catch (error) {\r\n      console.error('Error writing message to file:', error);\r\n    }\r\n  }\r\n\r\n  public async run(fileResult: IReadFileResult): Promise<string> {\r\n    this.openai.resetParentMessage();\r\n    const message = await this.openai.run(fileResult);\r\n    if (!message?.length) return;\r\n\r\n    const extractCode = message.map((m) => getAllCodeBlock(m)).join('\\n');\r\n    this.writeMessageToFile(fileResult, extractCode);\r\n\r\n    return extractCode;\r\n  }\r\n}\r\n\r\nexport default HermesTranslate;\r\n","import inquirer from 'inquirer';\r\nimport ora from 'ora';\r\n\r\nimport CreateCodeGenerator from './code-generator';\r\nimport {\r\n  OptionType,\r\n  OptionTypeExtension,\r\n  messages,\r\n  optionShortcuts,\r\n} from './constant';\r\n\r\n/**\r\n * Hermes Create CLI\r\n */\r\nclass CreateCLI {\r\n  private codeGenerator: CreateCodeGenerator;\r\n\r\n  constructor() {\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.codeGenerator = new CreateCodeGenerator();\r\n  }\r\n  /**\r\n   * Prompt option selection from user\r\n   */\r\n  private async promptOptionSelection(): Promise<OptionType> {\r\n    const { option } = await inquirer.prompt([\r\n      {\r\n        type: 'list',\r\n        name: 'option',\r\n        message: messages.selectOption,\r\n        choices: [\r\n          OptionType.Models,\r\n          OptionType.Sections,\r\n          OptionType.Pages,\r\n          OptionType.Components,\r\n        ].map((option) => ({\r\n          name: `${option} (${optionShortcuts[option]})`,\r\n          value: option,\r\n        })),\r\n      },\r\n    ]);\r\n\r\n    return option as OptionType;\r\n  }\r\n\r\n  /**\r\n   * Prompt name from user\r\n   */\r\n  private async promptName(\r\n    option?: OptionType,\r\n    defaultName?: string,\r\n  ): Promise<string> {\r\n    const { name } = await inquirer.prompt([\r\n      {\r\n        type: 'input',\r\n        name: 'name',\r\n        default: defaultName || option ? 'index' : 'exampleModule',\r\n        message: option\r\n          ? messages.enterName(option)\r\n          : messages.enterDirectoryName,\r\n        validate: (input: string) => {\r\n          if (input.trim() === '') return messages.nameEmpty;\r\n          if (!/^[a-z]+(?:[A-Z][a-z]*)*$/.test(input))\r\n            return 'Name must be in camelCase.';\r\n          return true;\r\n        },\r\n      },\r\n    ]);\r\n\r\n    return name;\r\n  }\r\n\r\n  /**\r\n   * Prompt description from user\r\n   */\r\n  private async promptOptionDescription(option: OptionType): Promise<string> {\r\n    const { description } = await inquirer.prompt([\r\n      {\r\n        type: 'input',\r\n        name: 'description',\r\n        default: `Please input your requirements`,\r\n        message: messages.enterDescription(option),\r\n        validate: (input: string) =>\r\n          input.trim() !== '' || messages.descriptionEmpty,\r\n      },\r\n    ]);\r\n\r\n    return description;\r\n  }\r\n\r\n  /**\r\n   * Prompt continue or finish from user\r\n   */\r\n  private async promptContinueOrFinish(): Promise<boolean> {\r\n    const { action } = await inquirer.prompt([\r\n      {\r\n        type: 'list',\r\n        name: 'action',\r\n        message: messages.continueOrFinish,\r\n        choices: ['Continue', 'Finish'],\r\n      },\r\n    ]);\r\n\r\n    return action === 'Continue';\r\n  }\r\n\r\n  /**\r\n   * Start CLI\r\n   */\r\n  async start() {\r\n    // Prompt user for a directory name\r\n    let continuePrompt = true;\r\n\r\n    let dirName;\r\n    // If user says yes, prompt for options and create a file\r\n    while (continuePrompt) {\r\n      const selectedOption = await this.promptOptionSelection();\r\n      dirName = await this.promptName(undefined, dirName);\r\n      const name = await this.promptName(selectedOption);\r\n      const description = await this.promptOptionDescription(selectedOption);\r\n      const spinner = ora('[ ðŸ§™ hermes ] Processing...').start();\r\n\r\n      this.codeGenerator.setOptions({\r\n        option: selectedOption,\r\n        name,\r\n        dirName,\r\n        description,\r\n      });\r\n\r\n      await this.codeGenerator.generator();\r\n\r\n      spinner.stop();\r\n      continuePrompt = await this.promptContinueOrFinish();\r\n    }\r\n  }\r\n}\r\n\r\nexport { OptionType, OptionTypeExtension };\r\nexport default CreateCLI;\r\n","import fs from 'fs';\r\nimport path from 'path';\r\nimport { HermesCreate } from 'src/hermes';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport { getFileNameToCamelCase, makeDirExist } from 'src/utilities/helpers';\r\nimport { readPromptFile } from 'src/utilities/reader/read-prompt-file';\r\nimport getConflictResult from 'src/utilities/writer/write-conflict';\r\n\r\nimport { IOptionCreated, OptionType, OptionTypeExtension } from './constant';\r\n\r\ninterface IWriteFileOptions {\r\n  fileName: string;\r\n  fileContent: string;\r\n  optionType: OptionType;\r\n  needCreateDir?: boolean;\r\n  rootDirPath?: string;\r\n}\r\n\r\nclass CreateCodeGenerator {\r\n  private option: OptionType;\r\n  private description: string;\r\n  private dirName: string;\r\n  private name: string;\r\n  private hermes: HermesCreate;\r\n\r\n  constructor() {\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.hermes = new HermesCreate();\r\n  }\r\n\r\n  private getPrompts() {\r\n    const { option, description, dirName, name } = this;\r\n    const basePrompts = [\r\n      `${readPromptFile(`create-${option}.txt`)}\r\n            Please note is's modelName is \"${dirName}${getFileNameToCamelCase(\r\n        name,\r\n        true,\r\n      )}\", and reply \"${option}\" code by following requirements: ${description}.\r\n          `,\r\n    ];\r\n    if (option === OptionType.Models) {\r\n      basePrompts.push(\r\n        `${readPromptFile(`create-${OptionType.Services}.txt`)}\r\n            Note that you should consider the method name and relationship between the \"${\r\n              OptionType.Models\r\n            }\" that you reply before.\r\n            Please reply \"${\r\n              OptionType.Services\r\n            }\" code by following requirements: ${description}.\r\n          `,\r\n      );\r\n      basePrompts.push(\r\n        `${readPromptFile(`create-${OptionType.Mock}.txt`)}\r\n            Note that you should consider the requests api path and relationship between the \"${\r\n              OptionType.Services\r\n            }\" that you reply before.\r\n            Please reply \"${\r\n              OptionType.Mock\r\n            }\" code by following requirements: ${description}.\r\n          `,\r\n      );\r\n    }\r\n    return basePrompts;\r\n  }\r\n\r\n  private writeFile(options: IWriteFileOptions) {\r\n    const {\r\n      fileName,\r\n      fileContent,\r\n      needCreateDir,\r\n      optionType,\r\n      rootDirPath = '',\r\n    } = options;\r\n    const dirPath =\r\n      rootDirPath ||\r\n      path.join(\r\n        process.cwd(),\r\n        userOptions.options.readFilesRootName,\r\n        optionType,\r\n        needCreateDir ? getFileNameToCamelCase(this.dirName, true) : '',\r\n      );\r\n    makeDirExist(dirPath);\r\n    const filePath = path.join(\r\n      dirPath,\r\n      `${fileName}.${OptionTypeExtension[optionType]}`,\r\n    );\r\n\r\n    const existFileContent =\r\n      fs.existsSync(filePath) && fs.readFileSync(filePath, 'utf-8');\r\n    fs.writeFileSync(\r\n      filePath,\r\n      existFileContent\r\n        ? getConflictResult(existFileContent, fileContent)\r\n        : fileContent,\r\n    );\r\n  }\r\n\r\n  private handleModelsOption(dirName: string, name: string, message: string[]) {\r\n    const [modelContent, serviceContent, mockContent] = message;\r\n    const fileName = `${dirName}${getFileNameToCamelCase(name, true)}`;\r\n    this.writeFile({\r\n      fileName,\r\n      fileContent: modelContent,\r\n      needCreateDir: false,\r\n      optionType: OptionType.Models,\r\n    });\r\n    this.writeFile({\r\n      fileName,\r\n      fileContent: serviceContent,\r\n      needCreateDir: false,\r\n      optionType: OptionType.Services,\r\n    });\r\n    this.writeFile({\r\n      fileName,\r\n      fileContent: mockContent,\r\n      rootDirPath: path.join(process.cwd(), OptionType.Mock),\r\n      optionType: OptionType.Mock,\r\n    });\r\n  }\r\n\r\n  setOptions(options: IOptionCreated) {\r\n    this.option = options.option;\r\n    this.description = options.description;\r\n    this.dirName = options.dirName;\r\n    this.name = options.name;\r\n  }\r\n\r\n  async generator() {\r\n    const prompts = this.getPrompts();\r\n    const message = await this.hermes.run({ prompts });\r\n    if (!message.length) return;\r\n\r\n    if ([OptionType.Models].includes(this.option)) {\r\n      this.handleModelsOption(this.dirName, this.name, message);\r\n      return;\r\n    }\r\n\r\n    let optionType = this.option;\r\n    if ([OptionType.Sections].includes(this.option)) {\r\n      optionType = OptionType.Pages;\r\n    }\r\n\r\n    this.writeFile({\r\n      fileName: this.name,\r\n      fileContent: message.join('\\n'),\r\n      needCreateDir: true,\r\n      optionType: optionType,\r\n    });\r\n  }\r\n}\r\n\r\nexport default CreateCodeGenerator;\r\n","export enum OptionType {\r\n  Components = 'components',\r\n  Pages = 'pages',\r\n  Sections = 'sections',\r\n  Models = 'models',\r\n  Services = 'services',\r\n  Mock = 'mock',\r\n}\r\n\r\nexport const OptionTypeExtension = {\r\n  [OptionType.Components]: 'tsx',\r\n  [OptionType.Pages]: 'tsx',\r\n  [OptionType.Sections]: 'tsx',\r\n  [OptionType.Models]: 'ts',\r\n  [OptionType.Services]: 'ts',\r\n  [OptionType.Mock]: 'ts',\r\n};\r\n\r\nexport const optionShortcuts = {\r\n  [OptionType.Models]: '1',\r\n  [OptionType.Sections]: '2',\r\n  [OptionType.Pages]: '3',\r\n  [OptionType.Components]: '4',\r\n};\r\n\r\nexport interface IOptionCreated {\r\n  option: OptionType;\r\n  description: string;\r\n  dirName: string;\r\n  name: string;\r\n}\r\n\r\nexport const messages = {\r\n  selectOption: 'Select an option:',\r\n  enterDirectoryName: 'Enter a name for module (Directory Name):',\r\n  enterName: (option: string) => `Enter a name for the ${option}:`,\r\n  nameEmpty: 'Name cannot be empty.',\r\n  enterDescription: (option: string) =>\r\n    `Enter a description for the ${option}:`,\r\n  descriptionEmpty: 'Description cannot be empty.',\r\n  continueOrFinish: 'Do you want to continue or finish?',\r\n};\r\n","import fs from 'fs';\r\nimport inquirer from 'inquirer';\r\nimport ora from 'ora';\r\nimport { HermesModify } from 'src/hermes';\r\nimport { IReadFileResult } from 'src/types';\r\nimport { userOptions } from 'src/utilities/constant';\r\nimport getConflictResult from 'src/utilities/writer/write-conflict';\r\n\r\nclass ModifyCLI {\r\n  private hermes: HermesModify;\r\n\r\n  constructor(private readFileResult: IReadFileResult[]) {\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.hermes = new HermesModify();\r\n  }\r\n\r\n  private async promptOptionDescription(): Promise<string> {\r\n    const { description } = await inquirer.prompt([\r\n      {\r\n        type: 'input',\r\n        name: 'description',\r\n        default: `Please fix bugs or optimize my code, and extract constant variable or enum variable. if the function is complexity, please chunk it. If it's functional component, use react hooks optimize some UI component or functions. And add comments with ${\r\n          userOptions.options.translate || 'en'\r\n        } language for complexity logic steps.`,\r\n        messages: `Please input your modify requirements`,\r\n        validate: (input: string) =>\r\n          input.trim() !== '' || 'Description cannot be empty.',\r\n      },\r\n    ]);\r\n\r\n    return description;\r\n  }\r\n\r\n  private async promptContinueOrFinish(): Promise<boolean> {\r\n    const { action } = await inquirer.prompt([\r\n      {\r\n        type: 'list',\r\n        name: 'action',\r\n        message: 'Do you want to continue or finish?',\r\n        choices: ['Continue', 'Finish'],\r\n      },\r\n    ]);\r\n\r\n    return action === 'Continue';\r\n  }\r\n\r\n  private writeFile(filePath: string, newContent: string) {\r\n    fs.writeFileSync(\r\n      filePath,\r\n      getConflictResult(fs.readFileSync(filePath, 'utf-8'), newContent),\r\n    );\r\n  }\r\n\r\n  private async runSingleFile(\r\n    fileResult: IReadFileResult,\r\n    continueTimes: number,\r\n  ) {\r\n    if (!fileResult?.filePath) throw new Error('File path is empty');\r\n\r\n    console.log(`[ ðŸ§™ hermes ] Start modify ${fileResult.filePath}...`);\r\n    const description = await this.promptOptionDescription();\r\n    const spinner = ora(`[ ðŸ§™ hermes ] Processing...`).start();\r\n\r\n    const prompts = [\r\n      continueTimes === 0\r\n        ? `My fileContent is: ${fileResult.fileContent}.`\r\n        : '',\r\n      `Please modify previous code by following requirements: ${description}`,\r\n    ];\r\n    const message = await this.hermes.run({\r\n      ...this.readFileResult,\r\n      prompts: [prompts.join('\\n')],\r\n    });\r\n    if (!message?.length) {\r\n      spinner.stop();\r\n      return;\r\n    }\r\n\r\n    this.writeFile(fileResult.filePath, message.join('\\n'));\r\n\r\n    spinner.stop();\r\n  }\r\n\r\n  async start() {\r\n    if (!this.readFileResult?.length) throw new Error('File path is empty');\r\n\r\n    let continuePrompt = true;\r\n    let continueTimes = 0;\r\n\r\n    while (continuePrompt) {\r\n      for (const fileResult of this.readFileResult) {\r\n        await this.runSingleFile(fileResult, continueTimes);\r\n      }\r\n\r\n      continuePrompt = await this.promptContinueOrFinish();\r\n      continueTimes += 1;\r\n    }\r\n  }\r\n}\r\n\r\nexport default ModifyCLI;\r\n","import fs from 'fs';\r\nimport ora from 'ora';\r\nimport path from 'path';\r\nimport { userOptions } from 'src/utilities/constant';\r\n\r\nimport ReadTestFilePathsByDirectory from './reader-directory';\r\nimport StagedFileReader from './reader-git-stage';\r\nimport { IReadFileResult, ReadTypeEnum } from '../types';\r\n\r\nclass ReadFiles {\r\n  private dirPath: string;\r\n  private fileExtensions: string[];\r\n\r\n  constructor({\r\n    dirPath = userOptions.readFilesRoot,\r\n    fileExtensions = userOptions.readFilesExtensions,\r\n  } = {}) {\r\n    this.dirPath = dirPath;\r\n    this.fileExtensions = fileExtensions;\r\n  }\r\n\r\n  readTypeMap: Record<ReadTypeEnum, () => IReadFileResult[]> = {\r\n    [ReadTypeEnum.Directory]: () => this.getTestFilePathByDir(),\r\n    [ReadTypeEnum.GitStage]: () => this.getTestFilePathByGit(),\r\n  };\r\n\r\n  private getTestFilePathByDir(): IReadFileResult[] {\r\n    const reader = new ReadTestFilePathsByDirectory();\r\n    return reader.getDirFiles(this.dirPath);\r\n  }\r\n\r\n  private getTestFilePathByGit(): IReadFileResult[] {\r\n    const reader = new StagedFileReader();\r\n    return reader.getStagedFiles();\r\n  }\r\n\r\n  private hasValidExtension(file: string): boolean {\r\n    const extension = path.extname(file);\r\n    if (!this.fileExtensions.length) return true;\r\n\r\n    return this.fileExtensions.some(\r\n      (ext) => ext === extension || ext === extension.slice(1),\r\n    );\r\n  }\r\n\r\n  private isTestFile(file: string): boolean {\r\n    const extension = path.extname(file);\r\n    const testFileType = userOptions.options.testFileType;\r\n    return file.endsWith(`.${testFileType}${extension}`);\r\n  }\r\n\r\n  public getFileResults(\r\n    readFileType = userOptions.readFileType,\r\n  ): IReadFileResult[] {\r\n    if (!this.readTypeMap[readFileType])\r\n      throw new Error('Invalid test file read type');\r\n\r\n    const readSpinner = ora({\r\n      text: 'ðŸª„ [ ðŸ§™ hermes ] Reading files...',\r\n    }).start();\r\n\r\n    try {\r\n      const fileResults = this.readTypeMap[readFileType]().filter(\r\n        ({ filePath: path }) =>\r\n          path && this.hasValidExtension(path) && !this.isTestFile(path),\r\n      );\r\n\r\n      if (userOptions.options.debug) {\r\n        console.log(\r\n          '[ ðŸ§™ hermes ] read files ===>',\r\n          fileResults.map((r) => r.filePath),\r\n        );\r\n      }\r\n\r\n      fileResults.length > 0\r\n        ? readSpinner.succeed(\r\n            'ðŸŒŸðŸŒŸ [ ðŸ§™ hermes ] read files successfully! ðŸŒŸðŸŒŸ',\r\n          )\r\n        : readSpinner.warn('ðŸ¤”ðŸ¤” [ ðŸ§™ hermes ] read no files! ðŸ¤”ðŸ¤”');\r\n      return fileResults;\r\n    } catch (error) {\r\n      readSpinner.fail(`[ ðŸ§™ hermes ] read files failed: ${error}`);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nexport default ReadFiles;\r\n","import fs from 'fs';\r\nimport path from 'path';\r\n\r\nimport { IReadFileResult } from '../types';\r\n\r\nclass ReadTestFilePathsByDirectory {\r\n  private getFilesInDirectory(dirPath: string): string[] {\r\n    return fs.readdirSync(dirPath);\r\n  }\r\n\r\n  private isDirectory(filePath: string): boolean {\r\n    return fs.statSync(filePath).isDirectory();\r\n  }\r\n\r\n  private getSubDirectoryFilePaths(filePath: string): IReadFileResult[] {\r\n    return this.getDirFiles(filePath);\r\n  }\r\n\r\n  private getFileContent(filePath: string): string {\r\n    return fs.readFileSync(filePath, 'utf-8');\r\n  }\r\n\r\n  public getDirFiles(dirPath: string): IReadFileResult[] {\r\n    if (!this.isDirectory(dirPath)) {\r\n      return [{ filePath: dirPath, fileContent: this.getFileContent(dirPath) }];\r\n    }\r\n\r\n    const filesPath = this.getFilesInDirectory(dirPath);\r\n\r\n    return filesPath.reduce((fileResult: IReadFileResult[], file: string) => {\r\n      const filePath = path.join(dirPath, file);\r\n\r\n      if (this.isDirectory(filePath)) {\r\n        const subDirFileResults = this.getSubDirectoryFilePaths(filePath);\r\n        return [...fileResult, ...subDirFileResults];\r\n      }\r\n\r\n      return [\r\n        ...fileResult,\r\n        { filePath, fileContent: this.getFileContent(filePath) },\r\n      ];\r\n    }, [] as IReadFileResult[]);\r\n  }\r\n}\r\n\r\nexport default ReadTestFilePathsByDirectory;\r\n","import { execSync } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { userOptions } from 'src/utilities/constant';\r\n\r\nimport GitDiffExtractor from '../extractor/extract-modify-funcs';\r\nimport { IReadFileResult } from '../types';\r\n\r\nclass StagedFileReader {\r\n  private stagedFiles: IReadFileResult[];\r\n\r\n  constructor() {\r\n    this.stagedFiles = this.readStagedFiles();\r\n  }\r\n\r\n  private readStagedFiles(): IReadFileResult[] {\r\n    const files = execSync('git diff --cached --name-status')\r\n      .toString()\r\n      .split('\\n')\r\n      .filter(Boolean);\r\n    const readRootName = userOptions.options.readFilesRootName;\r\n    const readGitStatus =\r\n      userOptions.options.readGitStatus?.split(',').map((el) => el.trim()) ||\r\n      [];\r\n\r\n    if (!readRootName) throw new Error('readFilesRootName is not set');\r\n    if (!readGitStatus.length) {\r\n      console.warn('readGitStatus is not set, no reading staged files');\r\n      return [];\r\n    }\r\n\r\n    return files.reduce<IReadFileResult[]>((acc, file) => {\r\n      const fileSplitArr = file.split('\\t');\r\n      const status = fileSplitArr[0].slice(0, 1);\r\n      const filePath = fileSplitArr.slice(-1)[0];\r\n      const fullPath = path.join(process.cwd(), filePath);\r\n\r\n      if (\r\n        !readGitStatus.includes(status) ||\r\n        !filePath.startsWith(`${readRootName}/`) ||\r\n        !fs.existsSync(fullPath)\r\n      ) {\r\n        return acc;\r\n      }\r\n\r\n      const contents = fs.readFileSync(fullPath, 'utf-8');\r\n\r\n      if (status !== 'M') {\r\n        return [...acc, { filePath: fullPath, fileContent: contents }];\r\n      }\r\n\r\n      const codeExtractor = new GitDiffExtractor();\r\n      const modifiedContents =\r\n        codeExtractor.extractModifiedFunction(fullPath, contents) || '';\r\n      return [\r\n        ...acc,\r\n        {\r\n          filePath: fullPath,\r\n          fileContent: modifiedContents,\r\n        },\r\n      ];\r\n    }, []);\r\n  }\r\n\r\n  public getStagedFiles(): IReadFileResult[] {\r\n    return this.stagedFiles;\r\n  }\r\n}\r\n\r\nexport default StagedFileReader;\r\n","import { execSync } from 'child_process';\r\n\r\nclass GitDiffExtractor {\r\n  private getGitDiffOutput(filePath: string): string {\r\n    return execSync(`git diff --cached ${filePath}`).toString();\r\n  }\r\n\r\n  private getModifiedLineNumbers(diffLines: string[]): number[] {\r\n    const modifiedLineNumbers: number[] = [];\r\n    let currentLineNumber = 0;\r\n\r\n    for (const line of diffLines) {\r\n      if (line.startsWith('@@ ')) {\r\n        const match = line.match(/\\+(\\d+)/);\r\n        if (match) {\r\n          currentLineNumber = parseInt(match[1], 10) - 1;\r\n        }\r\n      } else if (\r\n        line.startsWith('+') &&\r\n        !line.startsWith('++') &&\r\n        !line.startsWith('@@')\r\n      ) {\r\n        modifiedLineNumbers.push(currentLineNumber);\r\n        currentLineNumber++;\r\n      } else if (!line.startsWith('-')) {\r\n        currentLineNumber++;\r\n      }\r\n    }\r\n\r\n    return modifiedLineNumbers;\r\n  }\r\n\r\n  private extractCodeBlock(lines: string[], lineNumber: number): string | null {\r\n    let startLine = lineNumber;\r\n    let endLine = lineNumber;\r\n    const blockPattern =\r\n      /^\\s*(?:export\\s+)?(?:default\\s+)?(?:async\\s+)?(?:function\\b|class\\b|.*=>|\\(.*\\)\\s*=>|\\(\\s*\\)\\s*=>)/;\r\n    const classPattern = /^\\s*(?:export\\s+)?(?:default\\s+)?class\\b/;\r\n\r\n    while (startLine >= 0 && !lines[startLine].match(blockPattern)) {\r\n      startLine--;\r\n    }\r\n\r\n    if (lines[startLine] && lines[startLine].match(classPattern)) {\r\n      endLine = this.findClosingBrace(lines, startLine);\r\n    } else {\r\n      let openBraces = 0;\r\n\r\n      for (let i = startLine; i < lines.length; i++) {\r\n        const line = lines[i];\r\n        openBraces += this.countChar(line, '{');\r\n        openBraces -= this.countChar(line, '}');\r\n\r\n        if (openBraces === 0) {\r\n          endLine = i;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (startLine < 0 || endLine >= lines.length || !lines[startLine]) {\r\n      return null;\r\n    }\r\n\r\n    return lines.slice(startLine, endLine + 1).join('\\n');\r\n  }\r\n\r\n  private findClosingBrace(lines: string[], startLine: number): number {\r\n    let openBraces = 0;\r\n\r\n    for (let i = startLine; i < lines.length; i++) {\r\n      const line = lines[i];\r\n      openBraces += this.countChar(line, '{');\r\n      openBraces -= this.countChar(line, '}');\r\n\r\n      if (openBraces === 0) {\r\n        return i;\r\n      }\r\n    }\r\n\r\n    return lines.length - 1;\r\n  }\r\n\r\n  private countChar(line: string, char: string): number {\r\n    return line?.split(char).length - 1 || 0;\r\n  }\r\n\r\n  private isCodeBlockContainedInExistingBlocks(\r\n    codeBlock: string,\r\n    existingBlocks: string[],\r\n  ): boolean {\r\n    for (const existingBlock of existingBlocks) {\r\n      if (existingBlock.includes(codeBlock)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private addCodeBlockIfNotContained(blocks: string[], newBlock: string): void {\r\n    if (\r\n      !this.isCodeBlockContainedInExistingBlocks(newBlock, blocks) &&\r\n      !blocks.includes(newBlock)\r\n    ) {\r\n      blocks.push(newBlock);\r\n    }\r\n  }\r\n\r\n  public extractModifiedFunction(\r\n    filePath: string,\r\n    contents: string,\r\n  ): string | null {\r\n    const diffOutput = this.getGitDiffOutput(filePath);\r\n    const diffLines = diffOutput?.split('\\n');\r\n    if (!diffLines || !contents) return null;\r\n\r\n    const modifiedLineNumbers = this.getModifiedLineNumbers(diffLines);\r\n    if (modifiedLineNumbers.length === 0) return null;\r\n\r\n    const lines = contents.split('\\n');\r\n    const extractedCodeBlocks: string[] = [];\r\n\r\n    for (const lineNumber of modifiedLineNumbers) {\r\n      const codeBlock = this.extractCodeBlock(lines, lineNumber);\r\n      if (codeBlock) {\r\n        this.addCodeBlockIfNotContained(extractedCodeBlocks, codeBlock);\r\n      }\r\n    }\r\n\r\n    return extractedCodeBlocks.join('\\n\\n');\r\n  }\r\n}\r\n\r\nexport default GitDiffExtractor;\r\n"],"mappings":"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","names":["fs","path","path","path","userOptions","execSync","fs","execSync","fs","sourceLines","targetLines","fs","fs","path","path","fs","fs","fs","fs","path","fs","fs","path","path","fs","fs","fs","ora","fs","path","path","fs","option","ora","fs","inquirer","ora","inquirer","fs","ora","ora","path","fs","path","execSync","fs","path","execSync","execSync","path","fs","path","ora"]}